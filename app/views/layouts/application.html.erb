<!DOCTYPE html>
<html>
  <head>
    <title>GymAPP - Sistema de Gerenciamento</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <%= javascript_importmap_tags %>
  </head>
  <body class="bg-gray-50 overflow-x-hidden" data-turbo-permanent>
    <!-- Loading indicator -->
    <div id="turbo-progress-bar" class="fixed top-0 left-0 z-50 h-1 bg-blue-600 transition-all duration-300 ease-out" style="width: 0%"></div>
    
    <!-- Hotwire Status Indicator (apenas em desenvolvimento) -->
    <% if Rails.env.development? %>
      <div id="hotwire-indicator" class="fixed bottom-4 left-4 bg-green-500 text-white px-3 py-1 rounded-full text-xs font-semibold shadow-lg z-50 flex items-center gap-2">
        <span class="animate-pulse">âš¡</span>
        <span>Hotwire Ativo</span>
      </div>
    <% end %>
    
    <!-- Mobile Menu Button -->
    <% if logged_in? %>
      <div class="lg:hidden fixed top-4 left-4 z-50">
        <button onclick="toggleMobileMenu()" class="p-2 bg-slate-900 text-white rounded-lg shadow-lg hover:bg-slate-800 transition-colors">
          <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
          </svg>
        </button>
      </div>
      
      <!-- Mobile Overlay -->
      <div id="mobile-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40 hidden" onclick="closeMobileMenu()"></div>
      
      <!-- Sidebar Mobile -->
      <aside id="sidebar-mobile" class="lg:hidden fixed inset-y-0 left-0 w-64 -translate-x-full transition-transform duration-300 ease-in-out z-40">
        <%= render 'layouts/navigation' %>
      </aside>
    <% end %>
    
    <div class="min-h-screen flex">
      <% if logged_in? %>
        <!-- Sidebar Desktop -->
        <div class="hidden lg:block w-64 flex-shrink-0">
          <div class="fixed w-64 h-full">
            <%= render 'layouts/navigation' %>
          </div>
        </div>
      <% end %>
      
      <div class="flex-1 flex flex-col min-w-0">
        <!-- Flash Messages -->
        <div id="flash_messages" data-turbo-permanent>
          <%= render 'layouts/flash', flash: flash %>
        </div>
        
        <!-- Main Content -->
        <main class="flex-1 p-4 lg:p-6 <%= logged_in? ? 'pt-16 lg:pt-6' : '' %> w-full" id="main">
          <%= yield %>
        </main>
      </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2" data-turbo-permanent></div>
    
    <!-- Modal Container -->
    <div id="modal-container" data-turbo-permanent></div>
  </body>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }
  </style>
  
  <script>
    function toggleMobileMenu() {
      const sidebar = document.getElementById('sidebar-mobile');
      const overlay = document.getElementById('mobile-overlay');
      
      sidebar.classList.toggle('-translate-x-full');
      overlay.classList.toggle('hidden');
    }
    
    function closeMobileMenu() {
      const sidebar = document.getElementById('sidebar-mobile');
      const overlay = document.getElementById('mobile-overlay');
      
      sidebar.classList.add('-translate-x-full');
      overlay.classList.add('hidden');
    }
  </script>
</html>
